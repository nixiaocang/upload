<!DOCTYPE html>
<!--[if lt IE 7 ]>
<html class="ie ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]>
<html class="ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]>
<html class="ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!-->
<html lang="en"> <!--<![endif]-->
<head>

    <!-- Basic Page Needs
  ================================================== -->
    <meta charset="utf-8">
    <title>前尘忆梦</title>
    <meta name="description" content="Free Responsive Html5 Css3 Templates Designed by Kimmy | ">
    <meta name="author" content="">

    <!-- Mobile Specific Metas
  ================================================== -->
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <!-- CSS
  ================================================== -->
    <link rel="stylesheet" href="css/zerogrid.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/responsive.css">
    <link rel="stylesheet" href="css/calendar.css">

    <!--[if lt IE 8]>
    <div style=' clear: both; text-align:center; position: relative;'>
        <a href="http://windows.microsoft.com/en-US/internet-explorer/products/ie/home?ocid=ie6_countdown_bannercode">
            <img src="http://storage.ie6countdown.com/assets/100/images/banners/warning_bar_0000_us.jpg" border="0"
                 height="42" width="820"
                 alt="You are using an outdated browser. For a faster, safer browsing experience, upgrade for free today."/>
        </a>
    </div>
    <![endif]-->
    <!--[if lt IE 9]>
    <script src="js/html5.js"></script>
    <script src="js/css3-mediaqueries.js"></script>
    <![endif]-->

    <link href='./images/s1.ico' rel='icon' type='image/x-icon'/>
    <script src="https://cdn.bootcss.com/angular.js/1.4.6/angular.min.js"></script>
    <style type="text/css">
        .tbtn {
            text-rendering: auto;
            letter-spacing: normal;
            word-spacing: normal;
            text-transform: none;
            text-indent: 0px;
            font: 11px system-ui;
            box-sizing: border-box;
            align-items: flex-start;
            margin: 0;
            -webkit-appearance: button;
            font-weight: normal;
            inset 0 1px 0 rgba(255, 255, 255, 0.2), 0 1px 2px rgba(0, 0, 0, 0.05);
            border-radius: 4px;
            border: 1px solid #ccc;
            vertical-align: middle;
            cursor: pointer;
            text-align: center;
            display: inline-block;
            padding: 4px 12px;
            margin-bottom: 0;
            font-size: 14px;
            line-height: 20px;
            border-color: rgba(0, 0, 0, 0.1) rgba(0, 0, 0, 0.1) rgba(0, 0, 0, 0.25);
            text-shadow: 0 -1px 0 rgba(0, 0, 0, 0.25);
            background-color: #76d2c5;
            color: #fff;

        }
    </style>

</head>
<body ng-app="myApp" ng-controller="myCtrl" ng-model="res">
<div class="wrap-body zerogrid">
    <!--------------Header--------------->
    <header>
        <div class="wrap-header">

            <div class="top">
                <div class="socials">
                    <ul>
                        <li><a href="#" title="facebook"><img src="images/socials/facebook-32x32.png"/></a></li>
                        <li><a href="#" title="google"><img src="images/socials/google-32x32.png"/></a></li>
                        <li><a href="#" title="twitter"><img src="images/socials/twitter-32x32.png"/></a></li>
                        <li><a href="#" title="rss"><img src="images/socials/rss-32x32.png"/></a></li>
                        <li><a href="#" title="youtube"><img src="images/socials/youtube-32x32.png"/></a></li>
                    </ul>
                </div>
                <div id="search">
                    <div class="button-search"></div>
                    <input type="text" value="Search..."
                           onfocus="if (this.value == &#39;Search...&#39;) {this.value = &#39;&#39;;}"
                           onblur="if (this.value == &#39;&#39;) {this.value = &#39;Search...&#39;;}">
                </div>
            </div>

            <div id="logo">
                <a href="#"><h1>静水流深</h1></a>
                <p>在每一条有形无形的流水之前,我都愿意自己是宁静得足以聆见水之清音的过客</p>
            </div>

            <nav>
                <div class="wrap-nav">
                    <div class="menu">
                        <ul>
                            <li><a href="index.html">Home</a></li>
                            <li><a href="addblog.html">Add</a></li>
                            <li><a href="about.html">About</a></li>
                            <li><a href="contact.html">Contact</a></li>

                        </ul>
                    </div>
                </div>
            </nav>

        </div>
    </header>

    <!--------------Content--------------->
    <section id="content">
        <div class="wrap-content">
            <div class="row block">
                <div id="sidebar" class="col-1-3">
                    <div class="wrap-col">
                        <div class="box">
                            <div id="calendar" class="calendar"></div>
                            <script src="js/jquery.min.js"></script>
                            <script src="js/calendar.js"></script>

                        </div>
                        <div class="box">
                            <div class="heading"><h2>Catalog</h2></div>
                            <div class="content">
                            </div>
                        </div>
                        <div class="box">
                            <div class="heading"><h2>Popular Post</h2></div>
                            <div class="content">
                            </div>
                        </div>
                    </div>
                </div>
                <div id="main-content" class="col-2-3">
                    <div>
                        <p>标题:</p>
                        <input type="text" ng-model="title" style="background: #FFF;	padding: 1px 1px 1px 33px;	width: 90%;	height: 28px;	border: 1px solid #EEEEEE;">
                        <!--<p>备注:</p>-->
                        <!--<input type="text" ng-model="subtitle" style="background: #FFF;	padding: 1px 1px 1px 33px;	width: 90%;	height: 28px;	border: 1px solid #EEEEEE;">-->
                    </div>
                    <div class="wrap-col">
                        <article>

                            <div class="content">
                                <script id="container" name="content" type="text/plain">
                                </script>
                            </div>
                            <div style="float: right">
                        <button class="tbtn" ng-click="save()">保存</button>
                    </div>
                        </article>
                    </div>
                </div>
            </div>
        </div>
    </section>
</div>
<script type="text/javascript" src="ueditor/ueditor.config.js"></script>
<script type="text/javascript" src="ueditor/ueditor.all.js"></script>
<script type="text/javascript">
    var app = angular.module('myApp', []);
    app.controller('myCtrl', function ($scope, $http) {
        var ue = UE.getEditor('container');

        var url = location.search;
        var text_id = url.split("=")[1]
        $http({method: 'POST', url: '/api/info', params: {text_id: text_id}}).success(function (response) {
            var res = response.result;
            res.content = decodeURIComponent(res.content);
            $scope.res = res;
            $scope.title = res.title;
            ue.ready(function () {
                ue.setContent(res.content);
            });


        });
        $scope.save=function() {
            var content = ue.getContent();
            var subtitle = ue.getContentTxt();
            var data = {
                "user_id": "jiaogf",
                "content": encodeURIComponent(content),
                "text_id": text_id,
                "title":$scope.title,
                "subtitle":subtitle.substring(0,300)

            };
            console.log(data);
            $http({method: 'POST', url: '/api/save', params: data}).success(function (response) {
                $scope.text_id = response.result;
                window.location.href = 'blog.html?text_id=' + $scope.text_id
            });
        };
    });

</script>
</body>
</html>